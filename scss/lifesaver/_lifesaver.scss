//
// + LifeSaver
// =============================================================================


@mixin save($arguments) {
  $arguments: process-arguments($arguments);

  $properties: nth($arguments, 1);
  $values:     nth($arguments, 2);
  $units:      nth($arguments, 3);
  $scale:      nth($arguments, 4);
  $flag:       nth($arguments, 5);

  $values: compress-matching-values($values);

  @each $property in $properties {
    @if is-null($values) or $property == 'position' {

      $map: values-to-map($property, $values);
      @each $unit in $units {
        @each $key in map-keys($map) {
          $property-key: append-suffix($property, $key);
          $value: process-value(map-get($map, $key), $unit, $scale);

          @if not is-null($value) {
            @if $property == 'border' {
              #{$property-key}: $value $extra $flag;
            }
            @else {
              #{$property-key}: $value $flag;
            }
          }
        }
      }

    }
    @else if length($values) < 5 and length($values) not 3 {

      @each $unit in $units {
        $result: null;

        @each $value in $values {
          $result: $result process-value($value, $unit, $scale);
        }

        @if $property == 'border' {
          #{$property}: $result $extra $flag;
        }
        @else {
          #{$property}: $result $flag;
        }
      }

    }
  }
}
